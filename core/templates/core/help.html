{% extends "base.html" %}
{% load static %}
{% load role_tags %}

{% block title %}Ayuda{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'core/css/help.css' %}">
{% endblock %}

{% block content %}
<div class="neu-page">

  <!-- HEADER -->
  <div class="neu-page-head mb-4">
    <h2 class="neu-title">Centro de Ayuda</h2>
    <p class="neu-subtitle">
      Esta sección explica qué puedes hacer dentro del sistema según tu rol.
    </p>
  </div>

  <!-- ===================================================== -->
  <!-- ADMIN -->
  <!-- ===================================================== -->
  {% if user|has_group:"admin" or user.is_superuser %}

  <div class="card neu-card p-4 mb-4">
    <h4 class="neu-section-title">Ayuda para Administradores</h4>

    <p>
      Como administrador, tienes acceso completo a todas las funciones del sistema.
      Tu rol principal es organizar el trabajo general del equipo y configurar la estructura del proyecto.
    </p>

    <ul>
      <li>Puedes crear, editar y eliminar usuarios del sistema.</li>
      <li>Puedes asignar roles al momento de crear cada usuario.</li>
      <li>Puedes crear proyectos, sprints, épicas y tareas principales.</li>
      <li>Puedes definir presupuestos y KPIs dentro de una tarea.</li>
      <li>Tienes acceso completo al dashboard y a todas las métricas.</li>
      <li>Puedes mover tareas libremente entre estados, incluso retrocederlas si es necesario.</li>
    </ul>

    <hr>

    <h5>Flujo recomendado de trabajo</h5>
    <p>
      Para que el sistema funcione correctamente y el progreso sea real, se recomienda seguir este orden:
    </p>

    <ol>
      <li>Crear un proyecto</li>
      <li>Crear un sprint</li>
      <li>Definir una épica</li>
      <li>Crear la tarea principal</li>
      <li>Dividir el trabajo en subtareas</li>
    </ol>

    <hr>

    <h5>Situaciones comunes</h5>
    <ul>
      <li>
        Si el sistema no permite crear más usuarios o proyectos, probablemente se alcanzó el límite del Plan Free.
      </li>
      <li>
        Si una tarea fue marcada como completada pero no cumple el objetivo, puedes devolverla a “En progreso”.
      </li>
      <li>
        Eliminar usuarios es permanente y elimina su acceso de forma definitiva.
      </li>
    </ul>
  </div>

  <!-- ===================================================== -->
  <!-- LEADER / SCRUM -->
  <!-- ===================================================== -->
  {% elif user|has_group:"leader" or user|has_group:"scrum" %}

  <div class="card neu-card p-4 mb-4">
    <h4 class="neu-section-title">Ayuda para Líderes o Scrum</h4>

    <p>
      Este rol está enfocado en la gestión diaria del trabajo del equipo.
      Puedes organizar tareas, hacer seguimiento y asegurar que el sprint avance correctamente.
    </p>

    <ul>
      <li>Puedes crear y administrar tareas operativas del equipo.</li>
      <li>Puedes actualizar estados y gestionar subtareas.</li>
      <li>Puedes usar las matrices para organizar prioridades.</li>
      <li>Puedes consultar el dashboard para revisar avances generales.</li>
    </ul>

    <hr>

    <h5>Restricciones del rol</h5>
    <ul>
      <li>No puedes crear usuarios ni modificar roles.</li>
      <li>No tienes control total sobre la estructura global del sistema.</li>
    </ul>

    <hr>

    <h5>Situaciones comunes</h5>
    <ul>
      <li>
        Si no ves el menú de usuarios, es porque esa función es exclusiva del administrador.
      </li>
      <li>
        Si una tarea no avanza, revisa si tiene subtareas pendientes o presupuesto insuficiente.
      </li>
    </ul>
  </div>

  <!-- ===================================================== -->
  <!-- USUARIO NORMAL -->
  <!-- ===================================================== -->
  {% else %}

  <div class="card neu-card p-4 mb-4">
    <h4 class="neu-section-title">Ayuda para Usuarios</h4>

    <p>
      Como usuario normal, tu acceso está enfocado únicamente en ejecutar tareas asignadas.
      No necesitas configurar proyectos, solo trabajar sobre tus pendientes.
    </p>

    <ul>
      <li>Puedes ver únicamente las tareas que te fueron asignadas.</li>
      <li>Puedes avanzar tareas hacia adelante dentro del flujo de trabajo.</li>
      <li>Puedes registrar tu Daily para reportar avances e impedimentos.</li>
      <li>Puedes registrar disponibilidad si tienes ausencias o bloqueos.</li>
    </ul>

    <hr>

    <h5>Limitaciones importantes</h5>
    <ul>
      <li>No puedes crear proyectos, épicas o tareas principales.</li>
      <li>No puedes mover tareas hacia estados anteriores.</li>
      <li>Si necesitas permisos adicionales, debes contactar a un administrador.</li>
    </ul>

    <hr>

    <h5>Situaciones comunes</h5>
    <ul>
      <li>
        Si el sistema no te deja retroceder una tarea, es una restricción normal del rol.
      </li>
      <li>
        Si no ves tareas nuevas, solo aparecerán aquellas que hayan sido asignadas directamente a ti.
      </li>
      <li>
        El Daily debe registrarse dentro del horario establecido por el equipo.
      </li>
    </ul>
  </div>

  {% endif %}

  <!-- ===================================================== -->
  <!-- GENERAL -->
  <!-- ===================================================== -->
  <div class="card neu-card p-4 mb-4">
    <h4 class="neu-section-title">Conceptos básicos</h4>

    <p>
      NeusiTaskManager organiza el trabajo de forma estructurada. Estos términos son importantes:
    </p>

    <ul>
      <li><strong>Proyecto:</strong> contenedor principal del trabajo.</li>
      <li><strong>Sprint:</strong> Define el periodo en que se ejecutan tareas planificadas.</li>
      <li><strong>Épica:</strong> bloque grande que agrupa funcionalidades.</li>
      <li><strong>Tarea principal:</strong> unidad central de trabajo.</li>
      <li><strong>Subtarea:</strong> actividad específica que consume presupuesto.</li>
      <li><strong>Daily:</strong> reporte diario del progreso.</li>
      <li><strong>Disponibilidad:</strong> registro de ausencias, reuniones o bloqueos.</li>
    </ul>
  </div>

</div>
{% endblock %}
