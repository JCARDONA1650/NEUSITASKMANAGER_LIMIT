{% extends "base.html" %}
{% load static %}
{% load money %}

{% block title %}Proyectos{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'core/css/project_list.css' %}">
{% endblock %}

{% block content %}
<div class="neu-page neu-projects">

  <div class="neu-page-head">
    <div>
      <h2 class="neu-title">Proyectos</h2>
      <p class="neu-subtitle">Listado y control de proyectos, presupuesto y avance.</p>
    </div>

    <div class="neu-actions">
      <a href="{% url 'project_create' %}" class="btn btn-primary neu-btn">+ Nuevo Proyecto</a>
    </div>
  </div>

  <div class="card neu-card p-3">
    <div class="table-responsive">
      <table class="table neu-table align-middle">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Presupuesto</th>
            <th>Presupuesto restante</th>
            <th>Progreso</th>
            <th class="text-end">Acciones</th>
          </tr>
        </thead>

        <tbody>
          {% for project in projects %}
            <tr>
              <td class="neu-td-strong">{{ project.name }}</td>
              <td class="neu-td-strong">{{ project.budget|cop }}</td>
              <td class="neu-td-strong">{{ project.remaining_budget|cop }}</td>
              <td>
                <span class="neu-pill neu-pill-progress">{{ project.progress_percent|floatformat:0 }}%</span>
              </td>
              <td class="text-end">
                <a href="{% url 'project_update' project.pk %}" class="btn btn-sm btn-outline-primary">Editar</a>

                <form method="post" action="{% url 'project_delete' project.pk %}" class="d-inline">
                  {% csrf_token %}
                  <button type="submit"
                          class="btn btn-sm btn-outline-danger"
                          onclick="return confirm('¿Eliminar este proyecto? Esta acción no se puede deshacer.');">
                    Eliminar
                  </button>
                </form>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="5" class="text-center neu-muted py-4">No hay proyectos creados.</td>
            </tr>
          {% endfor %}
        </tbody>

      </table>
    </div>
  </div>

</div>
{% endblock %}
